/* monocle v1.0.4 - 2013/9/11
   http://monocle.tapquo.com
   Copyright (c) 2013 Javi Jim√©nez Villar - Licensed MIT */
(function(){"use strict";var t,e,r,n,i=[].slice,o=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++){if(e in this&&this[e]===t)return e}return-1},s={}.hasOwnProperty,u=function(t,e){for(var r in e){if(s.call(e,r))t[r]=e[r]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.__super__=e.prototype;return t};t={bind:function(t,e){var r,n,i,o,s;n=t.split(" ");r=this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={});for(o=0,s=n.length;o<s;o++){i=n[o];r[i]||(r[i]=[]);r[i].push(e)}return this},trigger:function(){var t,e,r,n,o,s,u;t=1<=arguments.length?i.call(arguments,0):[];r=t.shift();n=this.hasOwnProperty("_callbacks")&&((u=this._callbacks)!=null?u[r]:void 0);if(!n){return}for(o=0,s=n.length;o<s;o++){e=n[o];if(e.apply(this,t)===false){break}}return true},unbind:function(t,e){var r,n,i,o,s,u;if(!t){this._callbacks={};return this}i=(u=this._callbacks)!=null?u[t]:void 0;if(!i){return this}if(!e){delete this._callbacks[t];return this}for(n=o=0,s=i.length;o<s;n=++o){r=i[n];if(!(r===e)){continue}i=i.slice();i.splice(n,1);this._callbacks[t]=i;break}return this}};n=["included","extended"];e=function(){t.include=function(t){var e,r,i;if(!t){throw new Error("include(obj) requires obj")}for(r in t){i=t[r];if(o.call(n,r)<0){this.prototype[r]=i}}e=t.included;if(e){e.apply(this)}return this};t.extend=function(t){var e,r,i;if(!t){throw new Error("extend(obj) requires obj")}for(e in t){r=t[e];if(o.call(n,e)<0){this[e]=r}}if((i=t.extended)!=null){i.apply(this)}return this};t.proxy=function(t){var e=this;return function(){return t.apply(e,arguments)}};t.prototype.proxy=function(t){var e=this;return function(){return t.apply(e,arguments)}};t.prototype.delay=function(t,e){return setTimeout(this.proxy(t),e||0)};function t(){if(typeof this.init==="function"){this.init(arguments)}}return t}();r=this.Monocle={};r.version="1.0.4";r.Events=t;r.Module=e;r.Templates={};r.Dom=function(){var t;t=1<=arguments.length?i.call(arguments,0):[];if(typeof $$!=="undefined"&&$$!==null){return $$.apply(null,t)}else{return $.apply(null,t)}};e.extend.call(r,t);e.create=function(t,e){var r,n;r=function(t){u(e,t);function e(){n=e.__super__.constructor.apply(this,arguments);return n}return e}(this);if(t){r.include(t)}if(e){r.extend(e)}if(typeof r.unbind==="function"){r.unbind()}return r};this.__=r.App={Model:{},View:{},Controller:{}};this.__Model=r.App.Model;this.__View=r.App.View;this.__Controller=r.App.Controller}).call(this);(function(){"use strict";var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,r=function(t,r){for(var n in r){if(e.call(r,n))t[n]=r[n]}function i(){this.constructor=t}i.prototype=r.prototype;t.prototype=new i;t.__super__=r.prototype;return t};Monocle.Controller=function(e){r(n,e);n.include(Monocle.Events);n.prototype.eventSplitter=/^(\S+)\s*(.*)$/;n.prototype.tag="div";function n(e){this.destroy=t(this.destroy,this);var r,i;this.className=this.constructor.name;if(typeof e==="string"){this.el=Monocle.Dom(e)}else{for(r in e){i=e[r];this[r]=i}}if(!this.el){this.el=Monocle.Dom(document.createElement(this.tag))}if(!this.events){this.events=this.constructor.events}if(!this.elements){this.elements=this.constructor.elements}if(this.events){this.delegateEvents()}if(this.elements){this.refreshElements()}n.__super__.constructor.apply(this,arguments)}n.prototype.delegateEvents=function(){var t,e,r,n,i,o,s;o=this.events;s=[];for(e in o){n=o[e];if(typeof n!=="function"){n=this.proxy(this[n])}r=e.match(this.eventSplitter);t=r[1];i=r[2];if(i===""){s.push(this.el.bind(t,n))}else{s.push(this.el.delegate(i,t,n))}}return s};n.prototype.refreshElements=function(){var t,e,r,n;r=this.elements;n=[];for(t in r){e=r[t];n.push(this[e]=this.el.find(t))}return n};n.prototype.destroy=function(){this.trigger("release");this.el.remove();return this.unbind()};return n}(Monocle.Module)}).call(this);(function(){"use strict";var t,e={}.hasOwnProperty,r=function(t,r){for(var n in r){if(e.call(r,n))t[n]=r[n]}function i(){this.constructor=t}i.prototype=r.prototype;t.prototype=new i;t.__super__=r.prototype;return t},n=[].slice;Monocle.Model=function(e){r(i,e);i.extend(Monocle.Events);i.records={};i.attributes=[];i.fields=function(){var t;t=1<=arguments.length?n.call(arguments,0):[];this.records={};if(t.length){this.attributes=t}this.attributes||(this.attributes=[]);this.unbind();return this};i.create=function(t){var e;e=new this(t);return e.save()};i.uid=function(){var e;return e=t()};i.exists=function(t){var e;try{return this.find(t)}catch(r){e=r;return false}};i.find=function(t){var e;e=this.records[t];return e.clone()};i.findBy=function(t,e){var r,n,i;i=this.records;for(n in i){r=i[n];if(r[t]===e){return r.clone()}}};i.select=function(t){var e,r,n;r=function(){var r,i;r=this.records;i=[];for(n in r){e=r[n];if(t(e)){i.push(e)}}return i}.call(this);return this.cloneArray(r)};i.each=function(t){var e,r,n,i;n=this.records;i=[];for(e in n){r=n[e];i.push(t(r.clone()))}return i};i.all=function(){return this.cloneArray(this.recordsValues())};i.count=function(){return this.recordsValues().length};i.cloneArray=function(t){var e,r,n,i;i=[];for(r=0,n=t.length;r<n;r++){e=t[r];i.push(e.clone())}return i};i.recordsValues=function(){var t,e,r,n;e=[];n=this.records;for(t in n){r=n[t];e.push(r)}return e};i.destroyAll=function(){return this.records={}};function i(t){i.__super__.constructor.apply(this,arguments);this.className=this.constructor.name;if(t){this.load(t)}this.uid=this.constructor.uid()}i.prototype.isNew=function(){return!this.exists()};i.prototype.exists=function(){return this.uid&&this.uid in this.constructor.records};i.prototype.clone=function(){return createObject(this)};i.prototype.load=function(t){var e,r;for(e in t){r=t[e];if(typeof this[e]==="function"){this[e](r)}else{this[e]=r}}return this};i.prototype.attributes=function(){var t,e,r,n,i;e={};i=this.constructor.attributes;for(r=0,n=i.length;r<n;r++){t=i[r];if(t in this){if(typeof this[t]==="function"){e[t]=this[t]()}else{e[t]=this[t]}}}return e};i.prototype.equal=function(t){return!!(t&&t.constructor===this.constructor&&t.uid&&t.uid===this.uid)};i.prototype.save=function(){var t,e;if(this.validate!=null){t=this.validate()}if(t){this.trigger("error",t);return false}this.trigger("beforeSave");e=this.isNew()?this.create():this.update();this.trigger("save");return e};i.prototype.updateAttributes=function(t){this.load(t);return this.save()};i.prototype.changeUID=function(t){var e;e=this.constructor.records;e[t]=e[this.uid];delete e[this.uid];this.uid=t;return this.save()};i.prototype.create=function(){var t;this.trigger("beforeCreate");t=new this.constructor(this.attributes());t.uid=this.uid;this.constructor.records[this.uid]=t;this.trigger("create");this.trigger("change","create");return t.clone()};i.prototype.update=function(){var t;this.trigger("beforeUpdate");t=this.constructor.records;t[this.uid].load(this.attributes());this.trigger("update");this.trigger("change","update");return t[this.uid].clone()};i.prototype.destroy=function(){this.trigger("beforeDestroy");delete this.constructor.records[this.uid];this.trigger("destroy");this.trigger("change","destroy");this.unbind();return this};i.prototype.clone=function(){return Object.create(this)};i.prototype.unbind=function(){return this.trigger("unbind")};i.prototype.trigger=function(){var t,e;t=1<=arguments.length?n.call(arguments,0):[];t.splice(1,0,this);return(e=this.constructor).trigger.apply(e,t)};return i}(Monocle.Module);if(typeof Object.create!=="function"){Object.create=function(t){var e;e=function(){};e.prototype=t;return new e}}t=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e,r;e=Math.random()*16|0;r=t==="x"?e:e&3|8;return r.toString(16)}).toUpperCase()}}).call(this);(function(){"use strict";var t,e,r,n,i={}.hasOwnProperty,o=function(t,e){for(var r in e){if(i.call(e,r))t[r]=e[r]}function n(){this.constructor=t}n.prototype=e.prototype;t.prototype=new n;t.__super__=e.prototype;return t},s=[].slice;Monocle.Route=function(i){var u;o(a,i);a.extend(Monocle.Events);a.historySupport=((u=window.history)!=null?u.pushState:void 0)!=null;a.routes=[];a.options={trigger:true,history:false};a.listen=function(t){if(t==null){t={}}this.options=this.extend(this.options,t);if(this.options.history){this.history=this.historySupport&&this.options.history}Monocle.Dom(window).bind(this.getEventName(),this.change);return this.change()};a.add=function(t,e){var r,n,i;if(typeof t==="object"&&!(t instanceof RegExp)){i=[];for(r in t){n=t[r];i.push(this.add(r,n))}return i}else{return this.routes.push(new this(t,e))}};a.unbind=function(){return Monocle.Dom(window).unbind(this.getEventName(),this.change)};a.navigate=function(){var t,e,r,n;t=1<=arguments.length?s.call(arguments,0):[];r={};e=t[t.length-1];if(typeof e==="object"){r=t.pop()}else if(typeof e==="boolean"){r.trigger=t.pop()}r=this.extend(this.options,r);n=t.join("/");if(n!==this.path){this.path=n;this.trigger("navigate",this.path);if(r.trigger){this.matchRoute(this.path,r)}if(this.history){history.pushState({},document.title,this.path)}else{window.location.hash=this.path}}return this};a.extend=function(t,e){var r,n;if(t==null){t={}}for(r in e){n=e[r];t[r]=n}return t};a.getEventName=function(){if(this.history){return"popstate"}else{return"hashchange"}};a.getPath=function(){var t;t=window.location.pathname;if(t.substr(0,1)!=="/"){t="/"+t}return t};a.getFragment=function(){return this.getHash().replace(e,"")};a.getHost=function(){return(document.location+"").replace(this.getPath()+this.getHash(),"")};a.getHash=function(){return window.location.hash};a.change=function(){var t;t=this.history?this.getPath():this.getFragment();if(t!==this.path){this.path=t;this.matchRoute(this.path)}return this};a.matchRoute=function(t,e){var r,n,i,o;o=this.routes;for(n=0,i=o.length;n<i;n++){r=o[n];if(r.match(t,e)){this.trigger("change",r,t);return r}}};function a(e,i){var o;this.path=e;this.callback=i;this.names=[];if(typeof e==="string"){r.lastIndex=0;while((o=r.exec(e))!==null){this.names.push(o[1])}n.lastIndex=0;while((o=n.exec(e))!==null){this.names.push(o[1])}e=e.replace(t,"\\$&").replace(r,"([^/]*)").replace(n,"(.*?)");this.route=new RegExp("^"+e+"$")}else{this.route=e}}a.prototype.match=function(t,e){var r,n,i,o,s,u;if(e==null){e={}}n=this.route.exec(t);if(!n){return false}e.match=n;if(this.names.length){u=n.slice(1);for(r=o=0,s=u.length;o<s;r=++o){i=u[r];e[this.names[r]]=i}}return this.callback.call(null,e)!==false};return a}(Monocle.Module);e=/^#*/;r=/:([\w\d]+)/g;n=/\*([\w\d]+)/g;t=/[-[\]{}()+?.,\\^$|#\s]/g;Monocle.Route.change=Monocle.Route.proxy(Monocle.Route.change);Monocle.Controller.include({route:function(t,e){return Monocle.Route.add(t,this.proxy(e))},routes:function(t){var e,r,n;n=[];for(e in t){r=t[e];n.push(this.route(e,r))}return n},url:function(){return Monocle.Route.navigate.apply(Monocle.Route,arguments)}})}).call(this);(function(){"use strict";Monocle.templayed=function(t,e){var r,n,i,o;n=function(t,e){var r,n,i;e=1;t=t.replace(/\.\.\//g,function(){e++;return""});n=["data[data.length - ",e,"]"];i=t==="."?[]:t.split(".");r=0;while(r<i.length){n.push("."+i[r]);r++}return n.join("")};o=function(t){return t.replace(/\{\{(!|&|\{)?\s*(.*?)\s*}}+/g,function(t,e,r){var o;if(e==="!"){return""}o=i++;return['"; var o',o," = ",n(r),", s",o," = (((typeof(o",o,') == "function" ? o',o,".call(data[data.length - 1]) : o",o,') || "") + ""); s += ',e?"s"+o:'(/[&"><]/.test(s'+o+") ? s"+o+'.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/>/g,"&gt;").replace(/</g,"&lt;") : s'+o+")",' + "'].join("")})};r=function(t){return o(t.replace(/\{\{(\^|#)(.*?)}}(.*?)\{\{\/\2}}/g,function(t,e,o,s){var u;u=i++;return['"; var o',u," = ",n(o),"; ",(e==="^"?["if ((o",u," instanceof Array) ? !o",u,".length : !o",u,') { s += "',r(s),'"; } ']:["if (typeof(o",u,') == "boolean" && o',u,') { s += "',r(s),'"; } else if (o',u,") { for (var i",u," = 0; i",u," < o",u,".length; i",u,"++) { data.push(o",u,"[i",u,']); s += "',r(s),'"; data.pop(); }}']).join(""),'; s += "'].join("")}))};i=0;return new Function("data",'data = [data], s = "'+r(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"))+'"; return s;')}}).call(this);(function(){"use strict";var t={}.hasOwnProperty,e=function(e,r){for(var n in r){if(t.call(r,n))e[n]=r[n]}function i(){this.constructor=e}i.prototype=r.prototype;e.prototype=new i;e.__super__=r.prototype;return e},r=[].slice;Monocle.View=function(t){e(n,t);n.container=void 0;n.template_uri=void 0;n.template=void 0;n.model=void 0;function n(t){n.__super__.constructor.apply(this,arguments);if(!this.template){this.template=this.constructor.template}if(!this.template){this._loadTemplateFrom(this.template_url)}if(!this.container){this.container=this.constructor.container}this.container=Monocle.Dom(this.container);this.container.attr("data-monocle",this.constructor.name)}n.prototype.html=function(){var t;t=1<=arguments.length?r.call(arguments,0):[];return this._html.apply(this,["html"].concat(r.call(t)))};n.prototype.append=function(){var t;t=1<=arguments.length?r.call(arguments,0):[];return this._html.apply(this,["append"].concat(r.call(t)))};n.prototype.prepend=function(){var t;t=1<=arguments.length?r.call(arguments,0):[];return this._html.apply(this,["prepend"].concat(r.call(t)))};n.prototype.remove=function(){return this.el.remove()};n.prototype.replace=function(t){var e,r;r=[this.el,Monocle.Dom(t.el||t)],e=r[0],this.el=r[1];e.replaceWith(this.el);this.delegateEvents(this.events);this.refreshElements();return this.el};n.prototype.refresh=function(){var t;t=Monocle.templayed(this.template)(this.model);return this.replace(t)};n.prototype._html=function(){var t,e,n,i;n=arguments[0],e=2<=arguments.length?r.call(arguments,1):[];e=function(){var r,n,i;i=[];for(r=0,n=e.length;r<n;r++){t=e[r];i.push(t.el||t)}return i}();i=Monocle.templayed(this.template).apply(null,e);this.replace(i);this.container[n](this.el);return this};n.prototype._loadTemplateFrom=function(t){var e,r;if(!Monocle.Templates[this.className]){e=typeof $$!=="undefined"&&$$!==null?$$:$;r=e.ajax({url:t,async:false,dataType:"text",error:function(){return console.error(arguments)}});if(typeof $$==="undefined"||$$===null){r=r.responseText}Monocle.Templates[this.className]=r}return this.template=Monocle.Templates[this.className]};return n}(Monocle.Controller)}).call(this);